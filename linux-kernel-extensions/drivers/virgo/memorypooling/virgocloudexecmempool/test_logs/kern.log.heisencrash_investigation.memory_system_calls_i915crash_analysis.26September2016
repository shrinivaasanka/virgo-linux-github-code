-------------------------------------------------------------------------------------------------------------------------------
Panic-free VIRGO memory cache primitives invocations - telnet client - virgo_cloud_malloc(), virgo_cloud_set(), virgo_cloud_get()
-------------------------------------------------------------------------------------------------------------------------------
Sep 26 12:38:30 shrinivaasanka-Inspiron-1545 kernel: [  150.526607] virgocloudexec_mempool_create(): after kernel_accept() : error = 0 
Sep 26 12:38:30 shrinivaasanka-Inspiron-1545 kernel: [  150.526614] virgo_cloudexec_mempool_service(): virgo mempool client thread per request 
Sep 26 12:38:30 shrinivaasanka-Inspiron-1545 kernel: [  150.526677] virgo_cloudexec_mempool_service(): virgo_mempool_ops.virgo_create() 
Sep 26 12:38:30 shrinivaasanka-Inspiron-1545 kernel: [  150.526681] virgo_mempool_client_thread(): virgo_mempool_ops.virgo_mempool_recvfrom()
Sep 26 12:38:30 shrinivaasanka-Inspiron-1545 kernel: [  150.526686] virgocloudexec_mempool_create(): before kernel_accept(); sock=f3234000 ... 
Sep 26 12:38:30 shrinivaasanka-Inspiron-1545 kernel: [  150.526690] virgocloudexec_mempool_recvfrom(): before kernel_recvmsg()
Sep 26 12:38:38 shrinivaasanka-Inspiron-1545 kernel: [  158.084254] virgocloudexec_mempool_recvfrom(): kernel_recvmsg() returns len: 25
Sep 26 12:38:38 shrinivaasanka-Inspiron-1545 kernel: [  158.084262] strip_control_M(): str=virgo_cloud_malloc(100)
Sep 26 12:38:38 shrinivaasanka-Inspiron-1545 kernel: [  158.084267] strip_control_M(): newstr=virgo_cloud_malloc(100) after carriage return newline strsep
Sep 26 12:38:38 shrinivaasanka-Inspiron-1545 kernel: [  158.084271] virgocloudexec_mempool_recvfrom(): kernel_recvmsg() returns in recv: iov.iov_base=virgo_cloud_malloc(100)
Sep 26 12:38:38 shrinivaasanka-Inspiron-1545 kernel: [  158.084271] , buffer: virgo_cloud_malloc(100)
Sep 26 12:38:38 shrinivaasanka-Inspiron-1545 kernel: [  158.084276] virgo_cloudexec_mempool: print_buffer(): 
Sep 26 12:38:40 shrinivaasanka-Inspiron-1545 kernel: [  160.189538] virgocloudexec_mempool_create(): after kernel_accept() : error = 0 
Sep 26 12:38:40 shrinivaasanka-Inspiron-1545 kernel: [  160.189543] virgo_cloudexec_mempool_service(): virgo mempool client thread per request 
Sep 26 12:38:40 shrinivaasanka-Inspiron-1545 kernel: [  160.189661] virgo_cloudexec_mempool_service(): virgo_mempool_ops.virgo_create() 
Sep 26 12:38:40 shrinivaasanka-Inspiron-1545 kernel: [  160.189666] virgocloudexec_mempool_create(): before kernel_accept(); sock=f3234000 ... 
Sep 26 12:38:40 shrinivaasanka-Inspiron-1545 kernel: [  160.189678] virgo_mempool_client_thread(): virgo_mempool_ops.virgo_mempool_recvfrom()
Sep 26 12:38:40 shrinivaasanka-Inspiron-1545 kernel: [  160.189683] virgocloudexec_mempool_recvfrom(): before kernel_recvmsg()
Sep 26 12:39:18 shrinivaasanka-Inspiron-1545 kernel: [  197.768426] virgocloudexec_mempool_recvfrom(): kernel_recvmsg() returns len: 45
Sep 26 12:39:18 shrinivaasanka-Inspiron-1545 kernel: [  197.768433] strip_control_M(): str=virgo_cloud_set(f1516a00,"26September2016")
Sep 26 12:39:18 shrinivaasanka-Inspiron-1545 kernel: [  197.768439] strip_control_M(): newstr=virgo_cloud_set(f1516a00,"26September2016") after carriage return newline strsep
Sep 26 12:39:18 shrinivaasanka-Inspiron-1545 kernel: [  197.768443] virgocloudexec_mempool_recvfrom(): kernel_recvmsg() returns in recv: iov.iov_base=virgo_cloud_set(f1516a00,"26September2016")
Sep 26 12:39:18 shrinivaasanka-Inspiron-1545 kernel: [  197.768443] , buffer: virgo_cloud_set(f1516a00,"26September2016")
Sep 26 12:39:18 shrinivaasanka-Inspiron-1545 kernel: [  197.768448] virgo_cloudexec_mempool: print_buffer(): 
Sep 26 12:39:18 shrinivaasanka-Inspiron-1545 kernel: [  197.768528] <6>[  197.769382] mempool_func(): virgo mempool kernelspace module returns value virgo_mempool_ret=f1516a00
Sep 26 12:39:18 shrinivaasanka-Inspiron-1545 kernel: [  197.769385] virgo_mempool_client_thread(): virgo_mempool_ops.virgo_mempool_sendto()
Sep 26 12:39:18 shrinivaasanka-Inspiron-1545 kernel: [  197.769388] virgocloudexec_mempool_sendto(): virgo_mempool_ret="26September2016"
Sep 26 12:39:18 shrinivaasanka-Inspiron-1545 kernel: [  197.769391] virgocloudexec_mempool_sendto(): address sent=f1516a00
Sep 26 12:39:18 shrinivaasanka-Inspiron-1545 kernel: [  197.769397] virgocloudexec_mempool_sendto(): before kernel_sendmsg() for send buffer: f1516a00
Sep 26 12:39:18 shrinivaasanka-Inspiron-1545 kernel: [  197.769434] virgocloudexec_mempool_sendto(): kernel_sendmsg() returns ret: 500
Sep 26 12:39:18 shrinivaasanka-Inspiron-1545 kernel: [  197.769462] virgocloudexec_mempool_sendto(): sock_release invoked on client socket 
Sep 26 12:39:19 shrinivaasanka-Inspiron-1545 kernel: [  199.470807] virgocloudexec_mempool_create(): after kernel_accept() : error = 0 
Sep 26 12:39:19 shrinivaasanka-Inspiron-1545 kernel: [  199.470812] virgo_cloudexec_mempool_service(): virgo mempool client thread per request 
Sep 26 12:39:19 shrinivaasanka-Inspiron-1545 kernel: [  199.471181] virgo_cloudexec_mempool_service(): virgo_mempool_ops.virgo_create() 
Sep 26 12:39:19 shrinivaasanka-Inspiron-1545 kernel: [  199.471186] virgocloudexec_mempool_create(): before kernel_accept(); sock=f3234000 ... 
Sep 26 12:39:19 shrinivaasanka-Inspiron-1545 kernel: [  199.471190] virgo_mempool_client_thread(): virgo_mempool_ops.virgo_mempool_recvfrom()
Sep 26 12:39:19 shrinivaasanka-Inspiron-1545 kernel: [  199.471192] virgocloudexec_mempool_recvfrom(): before kernel_recvmsg()
Sep 26 12:39:32 shrinivaasanka-Inspiron-1545 kernel: [  212.046291] virgocloudexec_mempool_recvfrom(): kernel_recvmsg() returns len: 27
Sep 26 12:39:32 shrinivaasanka-Inspiron-1545 kernel: [  212.046299] strip_control_M(): str=virgo_cloud_get(f1516a00)
Sep 26 12:39:32 shrinivaasanka-Inspiron-1545 kernel: [  212.046304] strip_control_M(): newstr=virgo_cloud_get(f1516a00) after carriage return newline strsep
Sep 26 12:39:32 shrinivaasanka-Inspiron-1545 kernel: [  212.046308] virgocloudexec_mempool_recvfrom(): kernel_recvmsg() returns in recv: iov.iov_base=virgo_cloud_get(f1516a00)
Sep 26 12:39:32 shrinivaasanka-Inspiron-1545 kernel: [  212.046308] , buffer: virgo_cloud_get(f1516a00)
Sep 26 12:39:32 shrinivaasanka-Inspiron-1545 kernel: [  212.046314] virgo_cloudexec_mempool: print_buffer(): 
Sep 26 12:39:32 shrinivaasanka-Inspiron-1545 kernel: [  212.046363] <6>[  212.047234] virgocloudexec_mempool_sendto(): data sent="26September2016"
Sep 26 12:39:32 shrinivaasanka-Inspiron-1545 kernel: [  212.047237] virgocloudexec_mempool_sendto(): before kernel_sendmsg() for send buffer: "26September2016"
Sep 26 12:39:32 shrinivaasanka-Inspiron-1545 kernel: [  212.047272] virgocloudexec_mempool_sendto(): kernel_sendmsg() returns ret: 500
Sep 26 12:39:32 shrinivaasanka-Inspiron-1545 kernel: [  212.047300] virgocloudexec_mempool_sendto(): sock_release invoked on client socket 
--------------------------------------------------------------------------------------------------------------------
Kernel Panic after successful VIRGO system calls invocation
--------------------------------------------------------------------------------------------------------------------
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.054376] BUG: unable to handle kernel paging request at 6e726573
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.054484] IP: [<c13557c3>] __sg_page_iter_next.part.9+0x33/0xa0
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.054575] *pdpt = 0000000034b04001 *pde = 0000000000000000 
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.054657] Oops: 0000 [#1] SMP 
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.054710] Modules linked in: xt_CHECKSUM iptable_mangle ipt_MASQUERADE nf_nat_masquera
de_ipv4 iptable_nat nf_nat_ipv4 bridge stp llc ebtable_filter ebtables nls_iso8859_1 cfg80211 bnep rfcomm binfmt_misc ip6t_REJECT nf_reject_ipv6
 i915 nf_log_ipv6 xt_hl ip6t_rt nf_conntrack_ipv6 nf_defrag_ipv6 ipt_REJECT nf_reject_ipv4 nf_log_ipv4 nf_log_common xt_LOG xt_limit xt_tcpudp x
t_addrtype nf_conntrack_ipv4 nf_defrag_ipv4 xt_conntrack ip6table_filter ip6_tables btusb btbcm btintel nf_conntrack_netbios_ns bluetooth nf_con
ntrack_broadcast nf_nat_ftp nf_nat nf_conntrack_ftp uvcvideo nf_conntrack dell_wmi gpio_ich sparse_keymap videobuf2_vmalloc videobuf2_memops vid
eobuf2_core snd_hda_codec_idt snd_hda_codec_generic v4l2_common snd_hda_intel iptable_filter virgo_cloudexec_mempool(O+) ip_tables virgo_cloud_m
empool_kernelspace(O) snd_hda_controller videodev dell_laptop x_tables i8k dcdbas snd_hda_codec virgo_queue(O) coretemp snd_hda_core snd_pcm kin
gcobra_main_kernelspace(O) media joydev serio_raw snd_hwdep virgo_kernel_analytics(O) snd_seq_midi snd_seq_midi_event snd_rawmidi lpc_ich snd_se
q mac_hid wmi snd_timer snd_seq_device drm_kms_helper snd shpchp parport_pc drm ppdev soundcore video i2c_algo_bit lp parport hid_generic usbhid
 hid ums_realtek(O) uas(O) usb_storage(O) psmouse ahci sky2 libahci
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.056576] CPU: 0 PID: 3755 Comm: Xorg Tainted: G           O    4.1.5 #15
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.056666] Hardware name: Dell Inc. Inspiron 1545                   /0J037P, BIOS A14 1
2/07/2009
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.056779] task: f496f7f0 ti: f27d2000 task.ti: f27d2000
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.056851] EIP: 0060:[<c13557c3>] EFLAGS: 00213246 CPU: 0
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.056925] EIP is at __sg_page_iter_next.part.9+0x33/0xa0
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.056997] EAX: f27d3db0 EBX: 6e72656b ECX: 00000000 EDX: 6e72656b
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057079] ESI: ed82a600 EDI: f9ed1a04 EBP: f27d3d94 ESP: f27d3d8c
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057160]  DS: 007b ES: 007b FS: 00d8 GS: 00e0 SS: 0068
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057231] CR0: 80050033 CR2: 6e726573 CR3: 35bbefa0 CR4: 000406f0
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057311] Stack:
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317]  ed82a600 ed82a600 f27d3d9c c1355845 f27d3dc8 f9e52f90 00000000 ed82a600
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317]  f27d3dc4 6e72656b 00000000 70736c65 00000001 00000000 ed82a600 f27d3ddc
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317]  f9e50ef4 ed82a600 00000000 ed82a61c f27d3e08 f9e5635b f5801cc0 f27d3e0c
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317] Call Trace:
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317]  [<c1355845>] __sg_page_iter_next+0x15/0x30
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317]  [<f9e52f90>] i915_gem_object_put_pages_gtt+0x90/0x190 [i915]
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317]  [<f9e50ef4>] i915_gem_object_put_pages+0x84/0xf0 [i915]
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317]  [<f9e5635b>] i915_gem_free_object+0x12b/0x2c0 [i915]
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317]  [<c119e8f5>] ? kfree+0x115/0x120
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317]  [<f897547f>] ? drm_vma_node_revoke+0x5f/0x70 [drm]
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317]  [<f895bddf>] drm_gem_object_free+0x1f/0x30 [drm]
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317]  [<f895c297>] drm_gem_object_handle_unreference_unlocked+0xf7/0x110 [drm]
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317]  [<f895c33b>] drm_gem_handle_delete+0x8b/0xd0 [drm]
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317]  [<f895c910>] ? drm_gem_handle_create+0x40/0x40 [drm]
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317]  [<f895c92d>] drm_gem_close_ioctl+0x1d/0x30 [drm]
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317]  [<f895d1cd>] drm_ioctl+0x19d/0x570 [drm]
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317]  [<f895c910>] ? drm_gem_handle_create+0x40/0x40 [drm]
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317]  [<c1181d7f>] ? __remove_shared_vm_struct+0x2f/0x40
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317]  [<c118259d>] ? unlink_file_vma+0x3d/0x50
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317]  [<c117bfe8>] ? free_pgtables+0xb8/0x110
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317]  [<c117bb28>] ? tlb_finish_mmu+0x18/0x40
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317]  [<c1181e77>] ? unmap_region+0x97/0xd0
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317]  [<f895d030>] ? drm_getmap+0xc0/0xc0 [drm]
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317]  [<c11c8e22>] do_vfs_ioctl+0x322/0x550
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317]  [<c1181eee>] ? remove_vma+0x3e/0x50
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317]  [<c118425e>] ? do_munmap+0x1de/0x350
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317]  [<c11d1bd2>] ? __fget_light+0x22/0x60
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317]  [<c11c90b0>] SyS_ioctl+0x60/0x90
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317]  [<c170969b>] sysenter_do_call+0x12/0x12
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317] Code: 03 48 0c 8b 18 c7 40 0c 01 00 00 00 89 48 04 eb 1a 8d b4 26 00 00 00 00 8b 70 08 85 db 89 18 8d 56 ff 89 50 08 74 49 85 d2 74 45 <8b> 53 08 03 53 04 81 c2 ff 0f 00 00 c1 ea 0c 39 ca 77 4a 29 d1
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317] EIP: [<c13557c3>] __sg_page_iter_next.part.9+0x33/0xa0 SS:ESP 0068:f27d3d8c
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.057317] CR2: 000000006e726573
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.169118] ---[ end trace f1bbc49563472122 ]---
Sep 26 12:39:35 shrinivaasanka-Inspiron-1545 kernel: [  215.172793] usb_fill_bulk_urb(): urb->transfer_buffer = USBCN^A 
----------------------------------------------------------------------------------------------------------------------------------------
Crash pattern is similar to Boost::Python AsFer system call invocations. It appears that VIRGO system calls code and Boost::Python have
nothing to do with crashes in Intel i915 driver.
----------------------------------------------------------------------------------------------------------------------------------------
Failing kernel source in scatter-gather paging
----------------------------------------------------------------------------------------------------------------------------------------
(gdb) l *(0xc13557c3)
0xc13557c3 is in __sg_page_iter_next (/media/shrinivaasanka/0fc4d8a2-1c74-42b8-8099-9ef78d8c8ea2/home/kashrinivaasan/linux-4.1.5/lib/scatterlist.c:422).
417	in /media/shrinivaasanka/0fc4d8a2-1c74-42b8-8099-9ef78d8c8ea2/home/kashrinivaasan/linux-4.1.5/lib/scatterlist.c

bool __sg_page_iter_next(struct sg_page_iter *piter)
{
        if (!piter->__nents || !piter->sg)
                return false;

        piter->sg_pgoffset += piter->__pg_advance;
        piter->__pg_advance = 1;

        while (piter->sg_pgoffset >= sg_page_count(piter->sg)) {
                piter->sg_pgoffset -= sg_page_count(piter->sg);
                piter->sg = sg_next(piter->sg);
                if (!--piter->__nents || !piter->sg)
                        return false;
        }

        return true;
}
EXPORT_SYMBOL(__sg_page_iter_next);
-----------------------------------------------------------------------------------------------------------------------------------------
From GEM Design Document: http://lwn.net/Articles/283798/ (quite old article):
-----------------------------------------------------------------------------------------------------------------------------------------
An unidentified application is invoking ioctl (drm_gem_close_ioctl()) to free a page allocated in panic dump which is already freed probably. 
This is the oft-recurring pattern that happens only after a successful virgo system calls (or) cache primitives execution :
<Quote>
B. Closing

		struct drm_gem_close {
			/** Handle of the object to be closed. */
			uint32_t handle;
			uint32_t pad;
		};
		

		/* usage */
		close.handle = <handle>;
		ret = ioctl (fd, DRM_IOCTL_GEM_CLOSE, &close);
<Unquote>

On locking issues:
-----------------
"...
One significant operation which is explicitly left out of this API is object
locking. Applications are expected to perform locking of shared objects
outside of the GEM api. This kind of locking is not necessary to safely
manipulate the graphics engine, and with multiple objects interacting in
unknown ways, per-object locking would likely introduce all kinds of
lock-order issues. Punting this to the application seems like the only
sensible plan. Given that DRM already offers a global lock on the hardware,
this doesn't change the current situation.
..."

(Even If this is locking issue, VIRGO kernel syscalls/drivers code in no way interferes and manipulates with GPU GEM objects.VIRGO virgo_free()
code is presently not executed which might cause free() dangling conditions.)

----------------------------------------------------------------------------------------------------------------
Intel i915 kernel parameters for kernels older than 4.3.0 and above crash in Xorg
----------------------------------------------------------------------------------------------------------------
Previous crash happens in Xorg. X Server invokes GEM API for allocating buffers in GPU.
ArchLinux article - https://wiki.archlinux.org/index.php/intel_graphics - describes known crashes in i915 kmalloc() to circumevent which kernel parameters to be added are i915.enable_execlists=0 and i915.preliminary_hw_support=1. Similar parameters might be required for Ubuntu also. 
VIRGO syscalls/drivers invoke kmalloc() and they should be allocating addresses from /dev/kmem only. GPU allocations are handled by GTT in GPU
with preferential pinning of pages. Applications mmap() and munmap() the GEM objects to their process address spaces and objects are shared by a global hardware lock in GPU. Pinning basically saves the pages from hard eviction out of GPU GTT. Some crashes were observed in pinning too.
Mystery remains on how XServer mixes-up with VIRGO systemcalls/drivers. fget_light() in previous crash implies that application is not multithreaded and reference-counting is not touched. Essentially it boils down to: Something is wrong with XServer and i915 interaction.

----------------------------------------------------------------------------------------------------------------
Adding i915 kernel parameters has no effect on kernel panic - similar crash after above parameters in sysctl.conf
----------------------------------------------------------------------------------------------------------------
Successful VIRGO memory cache primitives telnet client execution:
----------------------------------------------------------------------------------------------------------------
Sep 26 17:29:56 shrinivaasanka-Inspiron-1545 kernel: [   22.112152] virgocloudexec_mempool_init(): invoking read_virgo_config()
Sep 26 17:29:56 shrinivaasanka-Inspiron-1545 kernel: [   22.112161] read_virgo_config(): virgo_cloud config file being read 
Sep 26 17:29:56 shrinivaasanka-Inspiron-1545 kernel: [   22.112168] do_virgo_cloud_init(): virgo_cloud config file string of comma separated IPs : 127.0.0.1,127.0.0.1
Sep 26 17:29:56 shrinivaasanka-Inspiron-1545 kernel: [   22.112180] tokenize_list_of_ip_addrs(): virgomemorypooling_node_ip_addrs_in_cloud[0] = 127.0.0.1
Sep 26 17:29:56 shrinivaasanka-Inspiron-1545 kernel: [   22.112187] tokenize_list_of_ip_addrs(): virgomemorypooling_node_ip_addrs_in_cloud[1] = 127.0.0.1
Sep 26 17:29:56 shrinivaasanka-Inspiron-1545 kernel: [   22.112203] virgocloudexec_mempool_init(): sock_create() returns error code: 0, sock=f2d1e600
Sep 26 17:29:56 shrinivaasanka-Inspiron-1545 kernel: [   22.112209] virgocloudexec_mempool_init(): kernel_bind() returns error code: 0
Sep 26 17:29:56 shrinivaasanka-Inspiron-1545 kernel: [   22.112218] virgocloudexec_mempool_init(): kernel_listen() returns error code: 0
Sep 26 17:29:56 shrinivaasanka-Inspiron-1545 kernel: [   22.112221] virgo_cloudexec_mempool_service(): virgo_mempool_ops.virgo_create() 
Sep 26 17:29:56 shrinivaasanka-Inspiron-1545 kernel: [   22.112224] virgocloudexec_mempool_create(): before kernel_accept(); sock=f2d1e600 ... 
Sep 26 17:33:23 shrinivaasanka-Inspiron-1545 kernel: [  229.743116] virgocloudexec_mempool_create(): after kernel_accept() : error = 0 
Sep 26 17:33:23 shrinivaasanka-Inspiron-1545 kernel: [  229.743121] virgo_cloudexec_mempool_service(): virgo mempool client thread per request 
Sep 26 17:33:23 shrinivaasanka-Inspiron-1545 kernel: [  229.743260] virgo_cloudexec_mempool_service(): virgo_mempool_ops.virgo_create() 
Sep 26 17:33:23 shrinivaasanka-Inspiron-1545 kernel: [  229.743264] virgocloudexec_mempool_create(): before kernel_accept(); sock=f2d1e600 ... 
Sep 26 17:33:23 shrinivaasanka-Inspiron-1545 kernel: [  229.743274] virgo_mempool_client_thread(): virgo_mempool_ops.virgo_mempool_recvfrom()
Sep 26 17:33:23 shrinivaasanka-Inspiron-1545 kernel: [  229.743277] virgocloudexec_mempool_recvfrom(): before kernel_recvmsg()
Sep 26 17:33:31 shrinivaasanka-Inspiron-1545 kernel: [  236.786439] virgocloudexec_mempool_recvfrom(): kernel_recvmsg() returns len: 25
Sep 26 17:33:31 shrinivaasanka-Inspiron-1545 kernel: [  236.786447] strip_control_M(): str=virgo_cloud_malloc(100)
Sep 26 17:33:31 shrinivaasanka-Inspiron-1545 kernel: [  236.786452] strip_control_M(): newstr=virgo_cloud_malloc(100) after carriage return newline strsep
Sep 26 17:33:31 shrinivaasanka-Inspiron-1545 kernel: [  236.786456] virgocloudexec_mempool_recvfrom(): kernel_recvmsg() returns in recv: iov.iov_base=virgo_cloud_malloc(100)
Sep 26 17:33:31 shrinivaasanka-Inspiron-1545 kernel: [  236.786456] , buffer: virgo_cloud_malloc(100)
Sep 26 17:33:31 shrinivaasanka-Inspiron-1545 kernel: [  236.786461] virgo_cloudexec_mempool: print_buffer(): 
Sep 26 17:33:33 shrinivaasanka-Inspiron-1545 kernel: [  239.305145] virgocloudexec_mempool_create(): after kernel_accept() : error = 0 
Sep 26 17:33:33 shrinivaasanka-Inspiron-1545 kernel: [  239.305150] virgo_cloudexec_mempool_service(): virgo mempool client thread per request 
Sep 26 17:33:33 shrinivaasanka-Inspiron-1545 kernel: [  239.305268] virgo_cloudexec_mempool_service(): virgo_mempool_ops.virgo_create() 
Sep 26 17:33:33 shrinivaasanka-Inspiron-1545 kernel: [  239.305272] virgocloudexec_mempool_create(): before kernel_accept(); sock=f2d1e600 ... 
Sep 26 17:33:33 shrinivaasanka-Inspiron-1545 kernel: [  239.305275] virgo_mempool_client_thread(): virgo_mempool_ops.virgo_mempool_recvfrom()
Sep 26 17:33:33 shrinivaasanka-Inspiron-1545 kernel: [  239.305278] virgocloudexec_mempool_recvfrom(): before kernel_recvmsg()
Sep 26 17:33:59 shrinivaasanka-Inspiron-1545 kernel: [  265.445454] virgocloudexec_mempool_recvfrom(): kernel_recvmsg() returns len: 47
Sep 26 17:33:59 shrinivaasanka-Inspiron-1545 kernel: [  265.445462] strip_control_M(): str=virgo_cloud_set(edc28a00,"26September2016_3")
Sep 26 17:33:59 shrinivaasanka-Inspiron-1545 kernel: [  265.445468] strip_control_M(): newstr=virgo_cloud_set(edc28a00,"26September2016_3") after carriage return newline strsep
Sep 26 17:33:59 shrinivaasanka-Inspiron-1545 kernel: [  265.445472] virgocloudexec_mempool_recvfrom(): kernel_recvmsg() returns in recv: iov.iov_base=virgo_cloud_set(edc28a00,"26September2016_3")
Sep 26 17:33:59 shrinivaasanka-Inspiron-1545 kernel: [  265.445472] , buffer: virgo_cloud_set(edc28a00,"26September2016_3")
Sep 26 17:33:59 shrinivaasanka-Inspiron-1545 kernel: [  265.445477] virgo_cloudexec_mempool: print_buffer(): 
Sep 26 17:33:59 shrinivaasanka-Inspiron-1545 kernel: [  265.445560] <6>[  265.446390] mempool_func(): virgo mempool kernelspace module returns value virgo_mempool_ret=edc28a00
Sep 26 17:33:59 shrinivaasanka-Inspiron-1545 kernel: [  265.446393] virgo_mempool_client_thread(): virgo_mempool_ops.virgo_mempool_sendto()
Sep 26 17:33:59 shrinivaasanka-Inspiron-1545 kernel: [  265.446396] virgocloudexec_mempool_sendto(): virgo_mempool_ret="26September2016_3"
Sep 26 17:33:59 shrinivaasanka-Inspiron-1545 kernel: [  265.446399] virgocloudexec_mempool_sendto(): address sent=edc28a00
Sep 26 17:33:59 shrinivaasanka-Inspiron-1545 kernel: [  265.446405] virgocloudexec_mempool_sendto(): before kernel_sendmsg() for send buffer: edc28a00
Sep 26 17:33:59 shrinivaasanka-Inspiron-1545 kernel: [  265.446439] virgocloudexec_mempool_sendto(): kernel_sendmsg() returns ret: 500
Sep 26 17:33:59 shrinivaasanka-Inspiron-1545 kernel: [  265.446468] virgocloudexec_mempool_sendto(): sock_release invoked on client socket 
Sep 26 17:34:00 shrinivaasanka-Inspiron-1545 kernel: [  266.501013] virgocloudexec_mempool_create(): after kernel_accept() : error = 0 
Sep 26 17:34:00 shrinivaasanka-Inspiron-1545 kernel: [  266.501017] virgo_cloudexec_mempool_service(): virgo mempool client thread per request 
Sep 26 17:34:00 shrinivaasanka-Inspiron-1545 kernel: [  266.501081] virgo_cloudexec_mempool_service(): virgo_mempool_ops.virgo_create() 
Sep 26 17:34:00 shrinivaasanka-Inspiron-1545 kernel: [  266.501085] virgo_mempool_client_thread(): virgo_mempool_ops.virgo_mempool_recvfrom()
Sep 26 17:34:00 shrinivaasanka-Inspiron-1545 kernel: [  266.501087] virgocloudexec_mempool_create(): before kernel_accept(); sock=f2d1e600 ... 
Sep 26 17:34:00 shrinivaasanka-Inspiron-1545 kernel: [  266.501094] virgocloudexec_mempool_recvfrom(): before kernel_recvmsg()
Sep 26 17:34:14 shrinivaasanka-Inspiron-1545 kernel: [  279.794387] virgocloudexec_mempool_recvfrom(): kernel_recvmsg() returns len: 27
Sep 26 17:34:14 shrinivaasanka-Inspiron-1545 kernel: [  279.794395] strip_control_M(): str=virgo_cloud_get(edc28a00)
Sep 26 17:34:14 shrinivaasanka-Inspiron-1545 kernel: [  279.794400] strip_control_M(): newstr=virgo_cloud_get(edc28a00) after carriage return newline strsep
Sep 26 17:34:14 shrinivaasanka-Inspiron-1545 kernel: [  279.794404] virgocloudexec_mempool_recvfrom(): kernel_recvmsg() returns in recv: iov.iov_base=virgo_cloud_get(edc28a00)
Sep 26 17:34:14 shrinivaasanka-Inspiron-1545 kernel: [  279.794404] , buffer: virgo_cloud_get(edc28a00)
Sep 26 17:34:14 shrinivaasanka-Inspiron-1545 kernel: [  279.794409] virgo_cloudexec_mempool: print_buffer(): 
Sep 26 17:34:14 shrinivaasanka-Inspiron-1545 kernel: [  279.794459] <6>[  279.795333] virgocloudexec_mempool_sendto(): data sent="26September2016_3"
Sep 26 17:34:14 shrinivaasanka-Inspiron-1545 kernel: [  279.795336] virgocloudexec_mempool_sendto(): before kernel_sendmsg() for send buffer: "26September2016_3"
Sep 26 17:34:14 shrinivaasanka-Inspiron-1545 kernel: [  279.795381] virgocloudexec_mempool_sendto(): kernel_sendmsg() returns ret: 500
-------------------------------------------------------------------------------------------------------------------------------------------
Crash after few seconds:
-------------------------------------------------------------------------------------------------------------------------------------------
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.118757] CPU: 0 PID: 3734 Comm: Xorg Tainted: G           O    4.1.5 #15
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.118847] Hardware name: Dell Inc. Inspiron 1545                   /0J037P, BIOS A14 1
2/07/2009
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.118961] task: edc92c30 ti: f48fe000 task.ti: f48fe000
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.119033] EIP: 0060:[<c13557c3>] EFLAGS: 00213246 CPU: 0
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.119106] EIP is at __sg_page_iter_next.part.9+0x33/0xa0
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.119181] EAX: f48ffdb0 EBX: 6e72656b ECX: 00000000 EDX: 6e72656b
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.119260] ESI: f4c59e00 EDI: f9f56a04 EBP: f48ffd94 ESP: f48ffd8c
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.119339]  DS: 007b ES: 007b FS: 00d8 GS: 00e0 SS: 0068
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.119407] CR0: 80050033 CR2: 6e726573 CR3: 2e01d600 CR4: 000406f0
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.119485] Stack:
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.119513]  f4c59e00 f4c59e00 f48ffd9c c1355845 f48ffdc8 f9ed7f90 00000000 f4c59e00
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.119627]  f48ffdc4 6e72656b 00000000 70736c65 00000001 00000000 f4c59e00 f48ffddc
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.119742]  f9ed5ef4 f4c59e00 00000000 f4c59e1c f48ffe08 f9edb35b c116127f 00000000
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.119856] Call Trace:
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.119892]  [<c1355845>] __sg_page_iter_next+0x15/0x30
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.119998]  [<f9ed7f90>] i915_gem_object_put_pages_gtt+0x90/0x190 [i915]
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.120117]  [<f9ed5ef4>] i915_gem_object_put_pages+0x84/0xf0 [i915]
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.120234]  [<f9edb35b>] i915_gem_free_object+0x12b/0x2c0 [i915]
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.120256]  [<c116127f>] ? release_pages+0x18f/0x200
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.120256]  [<f88dbddf>] drm_gem_object_free+0x1f/0x30 [drm]
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.120256]  [<f88dc297>] drm_gem_object_handle_unreference_unlocked+0xf7/0x110 [drm]
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.120256]  [<f88dc33b>] drm_gem_handle_delete+0x8b/0xd0 [drm]
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.120256]  [<f88dc910>] ? drm_gem_handle_create+0x40/0x40 [drm]
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.120256]  [<f88dc92d>] drm_gem_close_ioctl+0x1d/0x30 [drm]
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.120256]  [<f88dd1cd>] drm_ioctl+0x19d/0x570 [drm]
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.120256]  [<f88dc910>] ? drm_gem_handle_create+0x40/0x40 [drm]
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.120256]  [<c115a007>] ? __free_pages+0x27/0x30
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.120256]  [<c115a03a>] ? free_pages.part.83+0x2a/0x30
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.120256]  [<c115a051>] ? free_pages+0x11/0x20
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.120256]  [<c117bb39>] ? tlb_finish_mmu+0x29/0x40
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.120256]  [<c1181e77>] ? unmap_region+0x97/0xd0
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.120256]  [<f88dd030>] ? drm_getmap+0xc0/0xc0 [drm]
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.120256]  [<c11c8e22>] do_vfs_ioctl+0x322/0x550
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.120256]  [<c1181eee>] ? remove_vma+0x3e/0x50
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.120256]  [<c118425e>] ? do_munmap+0x1de/0x350
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.120256]  [<c11d1bd2>] ? __fget_light+0x22/0x60
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.120256]  [<c11c90b0>] SyS_ioctl+0x60/0x90
Sep 26 17:34:22 shrinivaasanka-Inspiron-1545 kernel: [  288.120256]  [<c170969b>] sysenter_do_call+0x12/0x12
-------------------------------------------------------------------------------------------------------------------------
Thus pattern emerging is: VIRGO syscalls/drivers code invoke kmalloc() and manipulate kmem which is in CPU control. Meanwhile
Xorg Server tries to free a GPU GTT GEM object (a separate thread likely). Previous kmalloc() code flow somehow creates a dangling
state by corrupting GPU GTT GEM which is later accessed by Xorg to trigger a panic - fget_light implies single threading. But kmalloc()
messing up with GPU GTT doesn't add up unless kmalloc() and kmem allocate objects from GPU (Is kmem VM+GPU?).
-------------------------------------------------------------------------------------------------------------------------- 
